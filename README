HSM in C++.

Your HSM class needs to use the template.
